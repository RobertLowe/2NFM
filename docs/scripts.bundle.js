webpackJsonp([0],[function(e,t){!function(){var e={},t=/([^&=]+)=?([^&]*)/g;function n(e){return decodeURIComponent(e.replace(/\+/g," "))}for(var a,o=window.location.search;a=t.exec(o.substring(1));)e[n(a[1])]=n(a[2]);window.params=Object.assign({},{s:"2nfm",bandwidth:8192},e)}();var n=document.getElementById("info-bar"),a=document.getElementsByTagName("BODY")[0],o=new RTCMultiConnection(params.s);o.socketURL="https://rtcmulticonnection.herokuapp.com:443/",o.autoCloseEntireSession=!0,o.socketMessageEvent="desktopCapture",o.enableLogs=!0,o.session={audio:!0,video:!0,data:!0,oneway:!0},o.sdpConstraints.mandatory={OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},o.getExternalIceServers=!1,o.iceServers=IceServersHandler.getIceServers(),o.processSdp=function(e){var t=params.bandwidth,n=params.codecs;if(t){try{t=parseInt(t)}catch(e){t=null}t&&NaN!=t&&"NaN"!=t&&"number"==typeof t&&(e=function(e){return e=(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:10000\r\n")}(e),e=BandwidthHandler.setVideoBitrates(e,{min:t,max:t}))}return n&&"default"!==n&&(e=CodecsHandler.preferCodec(e,n)),e},o.optionalArgument={optional:[],mandatory:{}},o.onstatechange=function(e){n.innerHTML=e.name+": "+e.reason,"request-rejected"==e.name&&params.p&&(n.innerHTML="Password ("+params.p+") did not match with broadcaster, that is why your participation request has been rejected.<br>Please contact him and ask for valid password."),"room-not-available"===e.name&&(n.innerHTML="Screen share session is closed or paused. You will join automatically when share session is resumed.")},o.onstreamid=function(e){n.innerHTML="Remote peer is about to send his screen."};var s=document.getElementById("play-button-container"),r=document.getElementById("volume-slider"),i=document.getElementById("video"),d=document.getElementById("audio");i.onplay=(e=>{s.classList.add("playing")}),i.onpause=(e=>{s.classList.remove("playing")}),d.onplay=(e=>{s.classList.add("playing")}),d.onpause=(e=>{s.classList.remove("playing")});var c=null;o.onstream=function(e){i.srcObject=null,d.srcObject=null,(c=e.stream).mute(),c.isVideo?(i.removeAttribute("hidden"),i.srcObject=c,i.srcObject.getVideoTracks()[0].enabled=!0,i.srcObject.getAudioTracks()[0].enabled=!0,i.volume=.5,i.play()):(d.removeAttribute("hidden"),d.srcObject=c,d.srcObject.getAudioTracks()[0].enabled=!0,d.volume=.5,d.play(),s.removeAttribute("disabled")),r.removeAttribute("disabled"),a.classList.add("stream-live")},window.togglePlayback=function(){c.isVideo?i.paused?i.play():i.pause():d.paused?d.play():d.pause()},window.setVolume=function(e){d.volume=e,i.volume=e},o.onleave=o.onstreamended=o.onSessionClosed=function(e){e.userid===params.s&&(i.srcObject=null,n.innerHTML="Screen sharing has been closed.",a.classList.remove("stream-live"),b.setAttribute("hidden",""),o.close(),o.closeSocket(),o.userid=o.token(),location.reload())},o.onJoinWithPassword=function(e){params.p||(params.p=prompt(e+" is password protected. Please enter the pasword:")),o.password=params.p,o.join(e)},o.onInvalidPassword=function(e,t){var n=prompt(e+" is password protected. Your entered wrong password ("+t+"). Please enter valid pasword:");o.password=n,o.join(e)},o.onPasswordMaxTriesOver=function(e){alert(e+" is password protected. Your max password tries exceeded the limit.")},o.onSocketDisconnect=function(e){o.getAllParticipants().length>0||location.reload()},o.onSocketError=function(e){alert("Unable to connect to the server. Please try again."),setTimeout(function(){location.reload()},1e3)},o.onopen=function(e){};var l=document.getElementById("chat-container"),u="";o.onmessage=function(e){!0===e.data.openChat&&l.removeAttribute("hidden"),!0===e.data.closeChat&&l.setAttribute("hidden",""),e.data.newChatMessage&&e.data.newChatMessage!=u&&(u=e.data.newChatMessage,g("Broadcaster",e.data.newChatMessage),function(e){h.innerHTML=e}(e.data.newChatMessage),o.send({receivedChatMessage:!0,checkmark_id:e.data.checkmark_id})),e.data.receivedChatMessage&&document.getElementById(e.data.checkmark_id)&&(document.getElementById(e.data.checkmark_id).style.display="")};var m=document.getElementById("txt-chat-message"),p=document.getElementById("chat-messages");function g(e,t,n){var a=document.createElement("div");a.innerHTML=n?'<p><span class="name">'+e+': <img class="checkmark" id="'+n+'" title="Received" src="images/checkmark.png"></span></p><p>'+t+"</p>":'<p><span class="name">'+e+":</span></p><p>"+t+"</p>",p.appendChild(a),p.scrollTop=p.clientHeight,p.scrollTop=p.scrollHeight-p.scrollTop}m.onkeyup=function(e){if(13===e.keyCode){var t=(100*Math.random()).toString().replace(".","");g("You",this.value,t),o.send({newChatMessage:this.value}),this.value=""}};var h=document.getElementById("tab-title");o.socketCustomEvent=params.s;let v=1e3;params.s&&function e(){o.checkPresence(params.s,function(t,a,s){if(!1===t){let t="No one is currently hosting the room: "+params.s;return n.innerHTML!=t&&(n.innerHTML=t),void setTimeout(function(){console.log("checked",v),v<6e4&&(v*=2),setTimeout(e,v)},4e3)}n.innerHTML="Joining room: "+params.s,o.password=null,params.p&&(o.password=params.p),o.join(params.s)})}();var f={};o.onPeerStateChanged=function(e){if(o.getRemoteStreams(params.s).length||("have-remote-offer"===e.signalingState?n.innerHTML="Received WebRTC offer from: "+params.s:"complete"===e.iceGatheringState&&"connected"===e.iceConnectionState&&(n.innerHTML="WebRTC handshake is completed. Waiting for remote video from: "+params.s)),"connected"===e.iceConnectionState&&"stable"===e.signalingState){if(f[e.userid])return;f[e.userid]=!0;var t=o.peers[e.userid].peer;getStats(t,function(t){!function(e,t){if(!o.peers[t]||y)return void e.nomore();var n="Video: "+e.video.recv.codecs;n+="<br>",n+="Resolution: "+e.resolutions.recv.width+"x"+e.resolutions.recv.height,n+="<br>",n+="Audio: "+e.audio.recv.codecs,n+="<br>",n+="Data: "+function(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}(e.audio.bytesReceived+e.video.bytesReceived),w.innerHTML=n}(t,e.userid),i.paused&&i.play()},1e3)}};var b=document.getElementById("stats-bar"),w=document.getElementById("stats-bar-html"),y=!1;document.getElementById("show-stats-bar").onclick=function(){b.toggleAttribute("hidden"),y=!1},document.getElementById("hide-stats-bar").onclick=function(){b.setAttribute("hidden",""),y=!0},document.getElementById("show-chats").onclick=function(){l.toggleAttribute("hidden"),p.scrollTo(0,p.scrollHeight)},window.addEventListener("offline",function(){n.innerHTML="You seem to be offline."},!1),window.addEventListener("online",function(){n.innerHTML="You are back online. Reloading the page...",location.reload()},!1),document.addEventListener("copy",function(e){e.clipboardData.setData("text/plain",e.target.textContent),e.preventDefault()})}],[0]);